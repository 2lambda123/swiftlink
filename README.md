SwiftLink: Parallel MCMC linkage analysis
=========

SwiftLink performs multipoint parametric linkage analysis on large consanguineous pedigrees and is primarily targeted at pedigrees that cannot be analysed by a Lander-Green algorithm based program, i.e. many markers, but larger pedigrees.

SwiftLink is licenced under the GPLv3.

Installation
---------

SwiftLink is only dependent on GNU scientific library for the Mersenne Twister PRNG (the versions of GSL tested are GSL 1.15 under MacOS and whatever is the default in the last two versions of Ubuntu). Optionally, SwiftLink can be compiled with CUDA support, see "Using CUDA" below for details about versions.

First clone the git repository:

    git clone git://github.com/ajm/swiftlink.git

Build with CUDA support:

    cd swiftlink/src
    make

Build without CUDA support:

    cd swiftlink/src
    make -f Makefile.nocuda

Input Files
---------

SwiftLink expects three input files: pedigree file, map file and data file, identical to standard LINKAGE format. We have mostly tested it on input files generated by [Alohomora](http://bioinformatics.oxfordjournals.org/content/21/9/2123.full.pdf) for Allegro.

Using CUDA
---------

SwiftLink does not work properly using CUDA versions 4.1 and 4.2 due to a known [slow down bug in cudaMalloc]( http://stackoverflow.com/questions/10320562/a-disastrous-slowdown-of-cudamalloc-in-nvidia-drivers-from-version-285 ), however it seems to work fine using CUDA 5.0 RC1 (anecdotally, CUDA 4.0 in 32-bit mode does not seem to suffer from this bug).

Options
---------

    Input files:
        -p pedfile, --pedigree=pedfile
        -m mapfile, --map=mapfile
        -d datfile, --dat=datfile

    Output files:
        -o outfile, --output=outfile            (default = 'swiftlink.out')

    MCMC options:
        -i NUM,     --iterations=NUM            (default = 90000)
        -b NUM,     --burnin=NUM                (default = 10000)
        -s NUM,     --sequentialimputation=NUM  (default = 1000)
        -x NUM,     --scoringperiod=NUM         (default = 10)
        -l FLOAT,   --lsamplerprobability=FLOAT (default = 0.5)
        -n NUM,     --lodscores=NUM             (default = 5)

    Runtime options:
        -c NUM,     --cores=NUM                 (default = 1)
        -g,         --gpu

    Misc:
        -q NUM,     --peelseqiter=NUM           (default = 1000000)
        -r seedfile,--randomseeds=seedfile
        -v,         --verbose
        -h,         --help

Example
---------

Assuming that the pedigree file, map file and data file are called ped, map and dat, respectively (see example directory), and that we want the results to be written to a file called results.out, this command:

    swift -p ped -m map -d dat -i 90000 -b 10000 -s 1000 -c 4 -g -o results.out

will perform linkage analysis by running the Markov chain for a total of 100,000 iterations, 10,000 of which are discarded as burnin. The initial state of the Markov chain will be found by running 1,000 rounds of sequential imputation. Work is spread over 4 CPU cores (-c 4) and the LOD scores will be calculated on the GPU (-g).

Caveats
---------

SwiftLink currently only supports autosomal linkage analysis.

